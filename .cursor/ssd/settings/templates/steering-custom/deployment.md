# 部署标准

[目的：安全、可重复的发布，具有清晰的环境和管道模式]

## 理念
- 自动化；部署前测试；部署后验证
- 偏好增量推出，快速回滚
- 生产更改必须可观察和可逆

## 环境
- Dev: 快速迭代；启用调试
- Staging: 镜像生产；发布验证
- Prod: 加固；监控；最小权限

## CI/CD流程
```
Code → Test → Build → Scan → Deploy (staged) → Verify
```
原则:
- 测试/扫描快速失败；阻止部署
- 工件构建可重现（锁定文件、固定版本）
- 生产需要手动批准；可审计跟踪

## 部署策略
- Rolling: 逐步实例替换
- Blue-Green: 在两个池之间切换流量
- Canary: 小%用户首先，根据健康扩展
根据风险配置文件选择；记录默认值。

## 零停机和迁移
- 健康检查门控流量；优雅关闭
- 在推出期间向后兼容的数据库更改
- 单独的迁移步骤；测试回滚路径

## 回滚
- 保持上一个版本就绪；自动化恢复
- 回滚比修复前进更快；记录触发器

## 配置和密钥
- 12因子配置通过环境；永远不提交密钥
- 密钥管理器；轮换；最小权限；审计访问
- 在启动时验证必需的环境变量

## 健康和监控
- 端点: `/health`、`/health/live`、`/health/ready`
- 监控延迟、错误率、吞吐量、饱和度
- 在SLO违规/峰值时告警；调整以避免疲劳

## 事件响应和灾难恢复
- 标准手册: 检测 → 评估 → 缓解 → 沟通 → 解决 → 事后分析
- 备份并保留；测试恢复；定义RPO/RTO

---
_关注推出模式和保障措施。无提供者特定步骤。_
